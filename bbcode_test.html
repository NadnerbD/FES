<html>
	<head>
		<script type="text/javascript" src="bbcode.js"></script>
		<link rel="stylesheet" type="text/css" href="bbcode.css" />
		<script type="text/javascript">
			// functionality for comment test preview
			var parser = new bbcode();
			parser.registerEmotes({backstab: "http://nadru.dyndns.org/Images/Backstab.png"});
			function preview(event) {
				event.preventDefault();
				var text = document.getElementById("input").value;
				var target = document.getElementById("preview");
				while(target.childNodes.length > 0) {
					target.removeChild(target.lastChild);
				}
				target.appendChild(parser.render(text));
			}
		</script>
		<script type="text/javascript">
			// fetch emoticon list
			var request = new XMLHttpRequest();
			request.onreadystatechange = function() {
				if(request.readyState == 4) {
					var emoteObject = {};
					var emoteList = JSON.parse(request.response);
					for(var i in emoteList) {
						emoteObject[emoteList[i][0]] = "emotes/" + emoteList[i][0] + ".png";
					}
					parser.registerEmotes(emoteObject);
					for(var key in emoteObject) {
						document.getElementById("input").value += ":" + key + ":";
					}
				}
			};
			request.open("GET", "emotes/emoticons.json", true);
			request.send(null);
		</script>
	</head>
	<body>
		<form onsubmit="preview(event)">
			<textarea rows="10" cols="80" id="input">[i]a[b]b[u]c[/i]d[/b]e[/u]
[s]test[/s]
&gt;&gt;0129385 &gt;&gt;blah
[i]blah[quote]te[/i][b]st[/quote]blah[/b]
[youtube =http://www.youtube.com/watch?v=UxPWYpcVI1c]

[spoiler]spoiler test[/spoiler]
[color=#F00][size=24]te[/color]st[/size]
[center]this is a :backstab:[/center]
[s][url=http://www.google.com]te[/s]st[/url]
[img]http://nadru.dyndns.org/Images/Backstab.png[/img][hr]</textarea>
			<input type="submit" />
		</form>
		<div id="preview">
		</div>
	</body>
</html>
